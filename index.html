<!DOCTYPE html>
<html lang="si">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>EarnHub Elite | Premium Earnings</title>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600;700&display=swap" rel="stylesheet">
    
    <script type="text/javascript" src="https://cdn.jsdelivr.net/npm/@emailjs/browser@3/dist/email.min.js"></script>
    <script async="async" data-cfasync="false" src="https://pl28695899.effectivegatecpm.com/d3b86a7a6ea6805fd2c9c7532410ddf5/invoke.js"></script>

    <style>
        :root { --primary: #00d2ff; --secondary: #3a7bd5; --success: #2ecc71; --warning: #f1c40f; --glass: rgba(255, 255, 255, 0.07); }
        * { box-sizing: border-box; font-family: 'Inter', sans-serif; }
        body { background: radial-gradient(circle at top right, #1e1e2f, #0f0c29); min-height: 100vh; margin: 0; color: #fff; cursor: pointer; overflow-x: hidden; }
        
        /* Navbar */
        .navbar { width: 100%; padding: 15px 20px; display: flex; align-items: center; position: sticky; top: 0; background: rgba(15, 12, 41, 0.9); backdrop-filter: blur(10px); z-index: 1000; border-bottom: 1px solid rgba(255,255,255,0.05); }
        .menu-btn { font-size: 24px; cursor: pointer; color: var(--primary); margin-right: 20px; }
        
        /* Sidebar */
        .sidebar { position: fixed; left: -280px; top: 0; width: 280px; height: 100%; background: #161625; transition: 0.3s; z-index: 2000; padding: 30px 20px; box-shadow: 10px 0 30px rgba(0,0,0,0.5); }
        .sidebar.active { left: 0; }
        .sidebar h2 { color: var(--primary); margin-bottom: 30px; border-bottom: 1px solid rgba(255,255,255,0.1); padding-bottom: 10px; }
        .sidebar-item { padding: 15px; border-radius: 12px; margin-bottom: 10px; cursor: pointer; display: flex; align-items: center; gap: 12px; color: #ccc; }
        .sidebar-item.active { background: var(--secondary); color: white; }
        
        .overlay { position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.7); display: none; z-index: 1500; }
        .overlay.active { display: block; }

        /* Container & Cards */
        .app-container { width: 100%; max-width: 500px; margin: 20px auto; padding: 0 15px; }
        .glass-card { background: var(--glass); backdrop-filter: blur(20px); padding: 25px 20px; border-radius: 25px; border: 1px solid rgba(255, 255, 255, 0.1); text-align: center; margin-bottom: 20px; }
        
        /* Badges Update */
        .badge-container { display: grid; grid-template-columns: repeat(3, 1fr); gap: 10px; margin-top: 25px; padding-top: 20px; border-top: 1px solid rgba(255,255,255,0.1); }
        .trust-badge { display: flex; flex-direction: column; align-items: center; text-align: center; }
        .trust-badge img { width: 30px; height: 30px; margin-bottom: 8px; filter: drop-shadow(0 0 5px var(--primary)); }
        .trust-badge span { font-size: 10px; font-weight: 700; color: var(--primary); text-transform: uppercase; margin-bottom: 4px; }
        .trust-badge p { font-size: 9px; color: #888; margin: 0; line-height: 1.2; }

        /* Buttons & Inputs */
        .btn-withdraw-main { width: 100%; padding: 20px; background: linear-gradient(45deg, #f1c40f, #e67e22); color: #000; font-size: 18px; font-weight: 800; border: none; border-radius: 15px; cursor: pointer; margin-bottom: 20px; }
        .btn-action { width: 100%; padding: 16px; border: none; border-radius: 12px; background: linear-gradient(45deg, var(--secondary), var(--primary)); color: #fff; font-weight: 600; cursor: pointer; }
        input, select { width: 100%; padding: 14px; border: none; border-radius: 12px; background: rgba(255, 255, 255, 0.1); color: #fff; margin-bottom: 15px; outline: none; text-align: center; }
        select { text-align-last: center; }
        option { background: #161625; }

        .captcha-display { font-size: 36px; font-weight: 800; letter-spacing: 8px; margin: 15px 0; color: #fff; text-shadow: 0 0 10px var(--primary); font-family: 'Courier New', monospace; }
        .list-item { display: flex; justify-content: space-between; align-items: center; padding: 12px; background: rgba(255,255,255,0.04); border-radius: 12px; margin-bottom: 8px; font-size: 13px; border-left: 3px solid var(--warning); }
        .history-card { text-align: left; background: rgba(255,255,255,0.05); padding: 15px; border-radius: 15px; margin-bottom: 10px; border-left: 4px solid var(--success); }
        
        #loginScreen, #mainDashboard, #historySection { display: none; }
    </style>
</head>
<body onclick="triggerGlobalAd()">

    <div class="overlay" id="overlay" onclick="toggleMenu()"></div>
    <div class="sidebar" id="sidebar">
        <h2>EarnHub Menu</h2>
        <div class="sidebar-item active" onclick="showSection('dashboard')">üè† Dashboard</div>
        <div class="sidebar-item" onclick="showSection('history')">üïí My Requests</div>
        <div class="sidebar-item" style="color:#ff4757; margin-top: 50px;" onclick="signOut()">üö™ Logout</div>
    </div>

    <div class="navbar" id="topNav" style="display: none;">
        <div class="menu-btn" onclick="toggleMenu()">‚ò∞</div>
        <div style="font-weight: 700; font-size: 18px;">EarnHub <span style="color:var(--primary);">Elite</span></div>
    </div>

<div class="app-container">
    <audio id="successSnd" src="https://assets.mixkit.co/active_storage/sfx/2013/2013-preview.mp3"></audio>

    <div id="loginScreen" class="glass-card" style="display: block;">
        <div style="font-size: 50px;">üõ°Ô∏è</div>
        <h1 style="margin-bottom: 10px;">EarnHub Elite</h1>
        <p style="font-size: 13px; color: #aaa; margin-bottom: 25px;">‡∂¥‡∑ê‡∂∫ 24 ‡∂¥‡∑î‡∂ª‡∑è ‡∂∏‡∑î‡∂Ø‡∂Ω‡∑ä ‡∂ã‡∂¥‡∂∫‡∂±‡∑ä‡∂± ‡∂Ø‡∑ê‡∂±‡∑ä‡∂∏ ‡∑É‡∂∏‡∑ä‡∂∂‡∂±‡∑ä‡∂∞ ‡∑Ä‡∂±‡∑ä‡∂±</p>
        
        <button class="btn-action" style="background:white; color:#333;" onclick="signIn()">
            <img src="https://www.gstatic.com/firebasejs/ui/2.0.0/images/auth/google.svg" width="18" style="vertical-align:middle; margin-right:8px;"> Sign in with Google
        </button>

        <div class="badge-container">
            <div class="trust-badge">
                <img src="https://cdn-icons-png.flaticon.com/512/2716/2716612.png">
                <span>SSL Secure</span>
                <p>‡∂Ø‡∂≠‡∑ä‡∂≠ ‡∂Ü‡∂ª‡∂ö‡∑ä‡∑Ç‡∑í‡∂≠‡∂∫‡∑í</p>
            </div>
            <div class="trust-badge">
                <img src="https://cdn-icons-png.flaticon.com/512/300/300221.png">
                <span>Verified</span>
                <p>‡∂≠‡∑Ñ‡∑Ä‡∑î‡∂ª‡∑î ‡∂ö‡∑Ö ‡∂Ö‡∂©‡∑Ä‡∑í‡∂∫‡∂ö‡∑í</p>
            </div>
            <div class="trust-badge">
                <img src="https://cdn-icons-png.flaticon.com/512/1162/1162250.png">
                <span>Fast Pay</span>
                <p>‡∂ö‡∂©‡∑í‡∂±‡∂∏‡∑ä ‡∂ú‡∑ô‡∑Ä‡∑ì‡∂∏‡∑ä</p>
            </div>
        </div>
    </div>

    <div id="mainDashboard">
        <button class="btn-withdraw-main" onclick="handleWithdrawClick()">üí∞ WITHDRAW REWARD</button>

        <div class="glass-card">
            <div style="display: flex; justify-content: space-between; margin-bottom: 20px;">
                <div style="text-align: left;"><small style="color: #888;">Worker</small><br><strong id="uNameDisp">...</strong></div>
                <div style="text-align: right;"><small style="color: #888;">Balance</small><br><strong id="uPointsDisp" style="color:var(--primary);">0 CP</strong></div>
            </div>

            <div id="workSection">
                <div class="captcha-display" id="captchaBox">----</div>
                <input type="number" id="userInput" placeholder="‡∂ö‡∑ö‡∂≠‡∂∫ ‡∂á‡∂≠‡∑î‡∑Ö‡∂≠‡∑ä ‡∂ö‡∂ª‡∂±‡∑ä‡∂±">
                <button class="btn-action" onclick="handleTask()">Submit & Earn 10 CP</button>
            </div>

            <div id="withdrawPanel" style="display: none;">
                <h3 style="color:var(--primary); margin-top: 0;">Request Payout</h3>
                <select id="payMethod" onchange="checkBankField()">
                    <option value="" disabled selected>Payment Method</option>
                    <option value="EzCash">EzCash / mCash</option>
                    <option value="MobileReload">Mobile Reload</option>
                    <option value="BankTransfer">Bank Transfer</option>
                </select>
                <select id="bankName" style="display:none;">
                    <option value="" disabled selected>Select Bank</option>
                    <option value="BOC">BOC</option>
                    <option value="Peoples">People's Bank</option>
                    <option value="Sampath">Sampath</option>
                    <option value="Commercial">Commercial</option>
                </select>
                <input type="text" id="payDetails" placeholder="Phone or Acc No">
                <button class="btn-action" style="background:var(--success);" onclick="submitReq()">Submit Now</button>
                <p onclick="hideWithdraw()" style="margin-top:15px; font-size:12px; color:#aaa; cursor:pointer;">Cancel</p>
            </div>
        </div>

        <div class="glass-card">
            <h3 style="text-align: left; color:#f1c40f; margin-top: 0;">üèÜ Top 5 Elite Leaders</h3>
            <div id="leaderList">Loading...</div>
        </div>
    </div>

    <div id="historySection">
        <div class="glass-card">
            <h2 style="text-align: left; margin-top: 0; color: var(--primary);">My History</h2>
            <div id="userHistoryList">No requests found.</div>
            <button class="btn-action" style="margin-top: 20px; background: rgba(255,255,255,0.05);" onclick="showSection('dashboard')">Back</button>
        </div>
    </div>
</div>

<script src="https://www.gstatic.com/firebasejs/9.0.0/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.0.0/firebase-auth-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.0.0/firebase-database-compat.js"></script>

<script>
    const firebaseConfig = {
        apiKey: "AIzaSyCBW21NQG7100ZQ_phXtVPiY-IWRzNCGu0",
        authDomain: "earn-money-600d9.firebaseapp.com",
        databaseURL: "https://earn-money-600d9-default-rtdb.firebaseio.com",
        projectId: "earn-money-600d9",
        storageBucket: "earn-money-600d9.firebasestorage.app",
        messagingSenderId: "12987052490",
        appId: "1:12987052490:web:4b349f2ad5a1812d9adf33"
    };

    firebase.initializeApp(firebaseConfig);
    const db = firebase.database();
    const auth = firebase.auth();
    const provider = new firebase.auth.GoogleAuthProvider();
    emailjs.init("CpK7Sb10QnKQlsqJa");

    let currentUID, currentPoints, uName, uEmail, userRank = 99;
    let lastAdTime = 0;
    const adCooldown = 45000;

    function toggleMenu() {
        document.getElementById("sidebar").classList.toggle("active");
        document.getElementById("overlay").classList.toggle("active");
    }

    function showSection(sec) {
        document.getElementById("mainDashboard").style.display = (sec === 'dashboard') ? "block" : "none";
        document.getElementById("historySection").style.display = (sec === 'history') ? "block" : "none";
        document.querySelectorAll('.sidebar-item').forEach((item, i) => item.classList.toggle('active', (i===0 && sec==='dashboard') || (i===1 && sec==='history')));
        if(sec === 'history') loadUserHistory();
        toggleMenu();
    }

    function triggerGlobalAd() {
        const now = Date.now();
        if (currentUID && (now - lastAdTime > adCooldown)) {
            lastAdTime = now;
            window.open('https://www.effectivegatecpm.com/bfifb4kf8?key=4848fcef5dd96ae01528e28c2c90fd4f', '_blank');
        }
    }

    function signIn() { auth.signInWithPopup(provider); }
    function signOut() { auth.signOut(); location.reload(); }

    auth.onAuthStateChanged(user => {
        if (user) {
            currentUID = user.uid; uName = user.displayName; uEmail = user.email;
            document.getElementById("loginScreen").style.display = "none";
            document.getElementById("mainDashboard").style.display = "block";
            document.getElementById("topNav").style.display = "flex";
            document.getElementById("uNameDisp").innerText = uName;
            startSync();
        }
    });

    function startSync() {
        db.ref('users/' + currentUID + '/points').on('value', s => {
            currentPoints = s.val() || 0;
            document.getElementById("uPointsDisp").innerText = currentPoints + " CP";
        });
        db.ref('users').orderByChild('points').limitToLast(5).on('value', s => {
            let list = []; s.forEach(child => { list.push({ uid: child.key, n: child.val().name, p: child.val().points }); });
            list.reverse();
            let html = "";
            list.forEach((u, i) => { if (u.uid === currentUID) userRank = i + 1; html += `<div class="list-item"><span><b>${i+1}.</b> ${u.n}</span><strong>${u.p} CP</strong></div>`; });
            document.getElementById("leaderList").innerHTML = html;
        });
    }

    async function loadUserHistory() {
        const histDiv = document.getElementById("userHistoryList");
        histDiv.innerHTML = "‡∂¥‡∑ñ‡∂ª‡∂´‡∂∫ ‡∑Ä‡∑ô‡∂∏‡∑í‡∂±‡∑ä ‡∂¥‡∑Ä‡∂≠‡∑ì...";
        const snapshot = await db.ref('requests').orderByChild('uid').equalTo(currentUID).once('value');
        if (snapshot.exists()) {
            let html = "";
            snapshot.forEach(child => {
                const req = child.val();
                html += `<div class="history-card"><small>${req.date}</small><div><b>${req.method}</b> - ${req.points} CP</div><small style="color:var(--success);">Status: Processing</small></div>`;
            });
            histDiv.innerHTML = html;
        } else { histDiv.innerHTML = "‡∂ö‡∑í‡∑É‡∑í‡∂Ø‡∑î ‡∑Ä‡∑è‡∂ª‡∑ä‡∂≠‡∑è‡∑Ä‡∂ö‡∑ä ‡∑Ñ‡∂∏‡∑î ‡∂±‡∑ú‡∑Ä‡∑ì‡∂∫."; }
    }

    function checkBankField() {
        const method = document.getElementById("payMethod").value;
        document.getElementById("bankName").style.display = (method === "BankTransfer") ? "block" : "none";
    }

    function handleWithdrawClick() {
        if (currentPoints < 500) alert("‡∂Ö‡∑Ä‡∂∏ ‡∑Ä‡∑Å‡∂∫‡∑ô‡∂±‡∑ä 500 CP ‡∂≠‡∑í‡∂∂‡∑í‡∂∫ ‡∂∫‡∑î‡∂≠‡∑î‡∂∫.");
        else if (userRank > 5) alert("‡∂∏‡∑î‡∂Ø‡∂Ω‡∑ä ‡∂Ω‡∂∂‡∑è‡∂ú‡∂≠ ‡∑Ñ‡∑ê‡∂ö‡∑ä‡∂ö‡∑ö Top 5 ‡∂Ö‡∂∫‡∂ß ‡∂¥‡∂∏‡∂´‡∑í.");
        else { document.getElementById("workSection").style.display = "none"; document.getElementById("withdrawPanel").style.display = "block"; }
    }

    function hideWithdraw() { document.getElementById("withdrawPanel").style.display = "none"; document.getElementById("workSection").style.display = "block"; }

    async function submitReq() {
        const m = document.getElementById("payMethod").value;
        const b = document.getElementById("bankName").value;
        const d = document.getElementById("payDetails").value;
        if(!m || !d) return alert("Fill all details!");
        let finalDetails = d; if(m === "BankTransfer") finalDetails = "Bank: " + b + " | Acc: " + d;

        const s = await db.ref('users/' + currentUID).once('value');
        if (Date.now() - (s.val().lastWithdraw || 0) < 86400000) return alert("‡∂Ø‡∑í‡∂±‡∂ö‡∂ß ‡∂ë‡∂ö‡∑ä ‡∑Ä‡∂ª‡∂ö‡∑ä ‡∂¥‡∂∏‡∂´‡∑í!");

        await db.ref('requests').push({ uid: currentUID, name: uName, points: currentPoints, method: m, details: finalDetails, date: new Date().toLocaleString() });
        await db.ref('users/' + currentUID + '/lastWithdraw').set(Date.now());
        alert("‡∑É‡∑è‡∂ª‡∑ä‡∂Æ‡∂ö‡∂∫‡∑í! ‡∂¥‡∑ê‡∂∫ 24‡∂ö‡∑ä ‡∂á‡∂≠‡∑î‡∑Ö‡∂≠ ‡∂∏‡∑î‡∂Ø‡∂Ω‡∑ä ‡∂Ω‡∑ê‡∂∂‡∑ô‡∂±‡∑î ‡∂á‡∂≠.");
        showSection('history');
    }

    let captchaCode;
    function genCaptcha() { captchaCode = Math.floor(1000 + Math.random() * 9000); document.getElementById("captchaBox").innerText = captchaCode; }

    async function handleTask() {
        const input = document.getElementById("userInput");
        if (input.value == captchaCode) {
            document.getElementById("successSnd").play();
            window.open('https://www.effectivegatecpm.com/bfifb4kf8?key=4848fcef5dd96ae01528e28c2c90fd4f', '_blank');
            await db.ref('users/' + currentUID + '/points').transaction(p => (p || 0) + 10);
            input.value = ""; genCaptcha();
        } else { alert("‡∑Ä‡∑ê‡∂ª‡∂Ø‡∑í ‡∂ö‡∑ö‡∂≠‡∂∫‡∂ö‡∑í!"); }
    }
    genCaptcha();
</script>
</body>
</html>
